{{- if .Site.Params.giscus.reactionsEnabled -}}
<!-- ÁÇπËµûÂíåÂèçÂ∫îÊåâÈíÆ -->
<div class="article-reactions" id="article-reactions">
  <div class="reaction-buttons">
    <button class="reaction-btn" data-reaction="thumbs_up" title="üëç ÁÇπËµû">
      <span class="reaction-icon">üëç</span>
      <span class="reaction-count" id="count-thumbs_up">0</span>
    </button>
    <button class="reaction-btn" data-reaction="heart" title="‚ù§Ô∏è ÂñúÊ¨¢">
      <span class="reaction-icon">‚ù§Ô∏è</span>
      <span class="reaction-count" id="count-heart">0</span>
    </button>
    <button class="reaction-btn" data-reaction="rocket" title="üöÄ ‰ºòÁßÄ">
      <span class="reaction-icon">üöÄ</span>
      <span class="reaction-count" id="count-rocket">0</span>
    </button>
    <button class="reaction-btn" data-reaction="eyes" title="üëÄ ÂÖ≥Ê≥®">
      <span class="reaction-icon">üëÄ</span>
      <span class="reaction-count" id="count-eyes">0</span>
    </button>
  </div>
  <div class="reaction-message" id="reaction-message"></div>
</div>

<style>
  .article-reactions {
    margin: 2rem 0;
    padding: 1rem;
    background: #fafafa;
    border-radius: 12px;
    border: 1px solid #e5e5e5;
  }

  .reaction-buttons {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    align-items: center;
  }

  .reaction-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: #fff;
    border: 1px solid #e5e5e5;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    color: #1a1a1a;
    transition: all 0.2s;
  }

  .reaction-btn:hover {
    border-color: #1a1a1a;
    background: #f5f5f5;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .reaction-btn:active {
    transform: translateY(0);
  }

  .reaction-icon {
    font-size: 18px;
  }

  .reaction-count {
    font-size: 14px;
    color: #666;
    font-weight: 600;
  }

  .reaction-message {
    margin-top: 0.75rem;
    font-size: 13px;
    color: #666;
    text-align: center;
    min-height: 20px;
  }

  @media (max-width: 768px) {
    .reaction-buttons {
      gap: 0.25rem;
    }

    .reaction-btn {
      padding: 0.4rem 0.6rem;
      font-size: 13px;
    }

    .reaction-icon {
      font-size: 16px;
    }
  }
</style>

<script>
  // ÁÇπËµûÂèçÂ∫îËÑöÊú¨
  (function() {
    const buttons = document.querySelectorAll('.reaction-btn');
    const messageEl = document.getElementById('reaction-message');

    // ‰ªé localStorage ËØªÂèñÂèçÂ∫îÊï∞ÊçÆ
    const getReactions = () => {
      const path = window.location.pathname;
      const data = localStorage.getItem(`reactions_${path}`);
      return data ? JSON.parse(data) : {};
    };

    // ‰øùÂ≠òÂèçÂ∫îÊï∞ÊçÆÂà∞ localStorage
    const saveReactions = (reactions) => {
      const path = window.location.pathname;
      localStorage.setItem(`reactions_${path}`, JSON.stringify(reactions));
    };

    // Êõ¥Êñ∞ÊòæÁ§∫
    const updateDisplay = () => {
      const reactions = getReactions();
      for (const [reaction, count] of Object.entries(reactions)) {
        const countEl = document.getElementById(`count-${reaction}`);
        if (countEl) {
          countEl.textContent = count;
        }
      }
    };

    // Ê∑ªÂä†ÂèçÂ∫î
    const addReaction = (reaction) => {
      const reactions = getReactions();
      if (!reactions[reaction]) {
        reactions[reaction] = 0;
      }
      reactions[reaction]++;
      saveReactions(reactions);
      updateDisplay();
      showMessage(`‰Ω†ÂèçÂ∫î‰∫Ü ${reaction === 'thumbs_up' ? 'üëç' : reaction === 'heart' ? '‚ù§Ô∏è' : reaction === 'rocket' ? 'üöÄ' : 'üëÄ'}`, 'success');
    };

    // ÊòæÁ§∫Ê∂àÊÅØ
    const showMessage = (text, type = 'info') => {
      if (messageEl) {
        messageEl.textContent = text;
        messageEl.style.color = type === 'success' ? '#16a34a' : '#666';
      }
    };

    // ÂàùÂßãÂåñ
    updateDisplay();

    // ÁªëÂÆöÁÇπÂáª‰∫ã‰ª∂
    buttons.forEach(btn => {
      btn.addEventListener('click', function() {
        const reaction = this.getAttribute('data-reaction');
        addReaction(reaction);

        // ÊªöÂä®Âà∞ËØÑËÆ∫Âå∫
        const giscusContainer = document.getElementById('giscus-container');
        if (giscusContainer) {
          setTimeout(() => {
            giscusContainer.scrollIntoView({ behavior: 'smooth' });
          }, 500);
        }
      });
    });
  })();
</script>
{{- end }}
